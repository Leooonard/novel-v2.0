<html>       
      <head>                
      <meta  charset="utf-8">                
      <title>动态路由配置实验</title>  
      <link rel="stylesheet" type="text/css" href="/media/css/bootstrap.css">  
      <link rel="stylesheet" type="text/css" href="/media/css/novel.css">
      <link rel="stylesheet" type="text/css" href="/media/css/dialog.css">
      <script type="text/javascript" src= "/media/script/jquery-1.10.2.min.js"></script>
      <script type="text/javascript" src= "/media/script/bootstrap.js"></script>
      <script type="text/javascript" src= "/media/script/model.js"></script>  
      <script type="text/javascript" src= "/media/script/view.js"></script>  
      <script type="text/javascript" src= "/media/script/util.js"></script>  
      <script type="text/javascript" src= "/media/script/controller.js"></script>  
      <script type="text/javascript" src= "/media/script/button-toggle.js"></script>
      <script type="text/javascript" src= "/media/script/dialog.js"></script>
      <style type="text/css"> 
            .labContainer{
                width: 1000px;
                height: 600px;
                background-color: white;
                outline: 1px solid red;
            }
            .padding20{
                padding: 20px;
            }
            .expand{
                  color: rgb(66, 139, 202);
                  margin: 10px 0px;
                  display: inline-block;
                  cursor: pointer;
            }
            .pointer{
                  cursor: pointer;
            }
            .floatRight{
                  float: right;
            }
            .marginRight20{
                  margin-right: 20px;
            }
            .form-control{
                width: 100% !important;
            }
            .div{
               position: absolute;
               outline: 1px solid red;
            }
      </style>   
      <script type="text/javascript">   
            $(document).ready(function(){
                var $labContainer= $(".labContainer");
                novelController.bindContainer($labContainer);
                var $createDevice= $("#createDevice");
                $createDevice.click(function(){
                    var routeModel= new novelModel.route();
                    var routeView= new novelView.Device().CreateRoute();
                    routeView.setStyle({
                        'left': '100px',
                        'top': '200px'
                    });
                    novelController.createDevice(routeModel, routeView);
                });

                /*var dialog= CreateFloatDetailedInfoDialog();
                var hostNetworkLayer= (new novelView.NetworkLayer()).createHostIPv4NetworkLayer();
                var routeNetworkLayer= (new novelView.NetworkLayer()).createRouteIPv4NetworkLayer();
                var physicalLayer= (new novelView.PhysicalLayer()).createP2PPhysicalLayer();
                var $div= $("<div></div>");
                $div.append(routeNetworkLayer.getHtmlView()).append(physicalLayer.getHtmlView());
                dialog.config({
                    "title": "设备",
                    "body": $div
                });

                buttonToggle();

                var move= function(e){
                    var $this= $(this);
                    var event= e|| window.event;
                    var moveX= event.pageX;
                    var moveY= event.pageY;
                    var width= moveX- x;
                    var height= moveY- y;
                    if(width< 0){
                         $div.css("left", moveX);
                         $div.css("width", Math.abs(width));
                         $div.find("canvas").attr("width", Math.abs(width));
                    }else{
                         $div.css("width", width);
                         $div.find("canvas").attr("width", width);
                    }
                    if(height< 0){
                         $div.css("top", moveY);
                         $div.css("height", Math.abs(height));
                         $div.find("canvas").attr("height", Math.abs(height));
                    }else{
                         $div.css("height", height);
                         $div.find("canvas").attr("height", height);
                    }
                    context.clearRect(0, 0, Math.abs(width), Math.abs(height));
                    if(width> 0&& height< 0){
                         context.moveTo(0, Math.abs(height));
                         context.lineTo(Math.abs(width), 0);
                    }else if(width< 0&& height> 0){   
                         context.moveTo(Math.abs(width), 0);
                         context.lineTo(0, Math.abs(height));
                    }else{
                         context.moveTo(0, 0);
                         context.lineTo(Math.abs(width), Math.abs(height));
                    }
                    context.stroke();
                };

                var $div= undefined;
                var context= undefined;
                var x= undefined, y= undefined;

                $("#div1").mousedown(function(e){
                    var $this= $(this);
                    var event= e|| window.event;
                    x= event.pageX;
                    y= event.pageY;
                    $div= $("<div><canvas></canvas></div>");
                    $div.css("padding", "10px");
                    context= $div.find("canvas").get(0).getContext("2d");
                    context.strokeStyle= "red";
                    $div.addClass("div");
                    $div.css("left", x);
                    $div.css("top", y);
                    $div.find("canvas").attr("width", "0").attr("height", "0");
                    $(document.body).mousemove(move);
                    $(document.body).append($div);
                     $(document.body).mouseup(function(){
                         $div.remove();
                         $(document.body).unbind("mouseup");
                         return false;
                     });
                    return false;
                });
                $("#div2").mouseup(function(){
                	var div1X= parseInt($("#div1").css("left"));
                	var div1Y= parseInt($("#div1").css("top"));
                	var div1Width= parseInt($("#div1").css("width"));
                	var div1Height= parseInt($("#div1").css("height"));
                	var div1cx= parseInt(div1X+ div1Width/ 2);
                	var div1cy= parseInt(div1Y+ div1Height/ 2);
                	var div2X= parseInt($("#div2").css("left"));
                	var div2Y= parseInt($("#div2").css("top"));
                	var div2Width= parseInt($("#div2").css("width"));
                	var div2Height= parseInt($("#div2").css("height"));
                	var div2cx= parseInt(div2X+ div2Width/ 2);
                	var div2cy= parseInt(div2Y+ div2Height/ 2);
                	console.log(div1cx+ " "+ div1cy+ " "+ div2cx+ " "+ div2cy);
                	if(div1cx< div2cx){
                		var left= div1cx;
                	}else if(div1cx== div2cx){
                		var left= div1cx;
                	}else{
                		var left= div2cx;
                	}
                	var width= div1cx- div2cx;
                	if(div1cy< div2cy){
                		var top= div2cy;
                	}else if(div1cy== div2cy){
                		var top= div1cy;
                	}else{
                		var top= div1cy;
                	}
                	var height= div1cy- div2cy;
                	$div.css("left", left).css("top", top).css("width", Math.abs(width)).css("height", Math.abs(height));
                    context.clearRect(0, 0, Math.abs(width), Math.abs(height));
                    if(width> 0&& height< 0){
                         context.moveTo(0, Math.abs(height));
                         context.lineTo(Math.abs(width), 0);
                    }else if(width< 0&& height> 0){   
                         context.moveTo(Math.abs(width), 0);
                         context.lineTo(0, Math.abs(height));
                    }else{
                         context.moveTo(0, 0);
                         context.lineTo(Math.abs(width), Math.abs(height));
                    }
                    context.stroke();
                    $(document.body).unbind("mousemove");
                    return false;
                });*/
            });
      </script>                      
      </head>        
     <body>
          <!-- <div id= "div1" style= "width: 100px; height: 100px; position: absolute; left: 100px; top: 100px; background-color: green;">
          </div>
          <div id= "div2" style= "width: 100px; height: 100px; position: absolute; left: 300px; top: 100px; background: red;"></div> -->
          <div class= 'labContainer'></div>
          <button class= 'btn btn-primary' id= 'createDevice'>创建设备</button>
     </body>
</html>
